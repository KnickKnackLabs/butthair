#!/usr/bin/env bash
#MISE description="Show the current space index and ID"
#USAGE flag "-i --index" help="Output just the index number"

set -e

TASKS_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")/.." && pwd)"
source "$TASKS_DIR/_hs"
hs_check

if [ "${usage_index:-false}" = "true" ]; then
    hs_run '
local screen = hs.screen.mainScreen()
local spaces = hs.spaces.spacesForScreen(screen)
local focused = hs.spaces.focusedSpace()
for i, sid in ipairs(spaces) do
    if sid == focused then return tostring(i) end
end
return "0"
'
else
    hs_run '
local screen = hs.screen.mainScreen()
local spaces = hs.spaces.spacesForScreen(screen)
local focused = hs.spaces.focusedSpace()
for i, sid in ipairs(spaces) do
    if sid == focused then
        return string.format("#%d (id=%d)", i, sid)
    end
end
return "unknown"
'
fi
